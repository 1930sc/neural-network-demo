function checkSanity(){sim.loadPreset("Binary Classifier for XOR");var t=[-.3180095069079748,-.2749093166215802,-.038532753589859546,.09576201205465842,-.3460678329225116,.23218797637289554,-.33191669283980774,.5140297481331861,-.1518989898989732],n=[-.3094657452311367,-.2758470894768834,.005968799814581871,.13201188389211893,-.33257930004037917,.24626848078332841,-.35734778200276196,.489376779878512,-.2165879353415221];sim.stop(),sim.config.inputLayer={neuronCount:2,names:["",""]},sim.config.hiddenLayers=[{neuronCount:2,activation:"sigmoid"}],sim.config.outputLayer={neuronCount:1,activation:"sigmoid",names:[""]},sim.net.connections.forEach(function(t,i){return t.weight=n[i]});for(var i=0;1e3>i;i++)sim.step();var e=sim.net.connections.map(function(t){return t.weight});if(e.every(function(n,i){return n!==t[i]}))throw"insanity!";return"ok"}var sim;$(document).ready(function(){Presets.loadPetersonBarney(),sim=new Simulation(!1)});var __extends=this.__extends||function(t,n){function i(){this.constructor=t}for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);i.prototype=n.prototype,t.prototype=new i},Net;!function(t){var n,i=function(t){if(t===1/0)return 1;if(t===-(1/0))return-1;var n=Math.exp(2*t);return(n-1)/(n+1)},e={sigmoid:{f:function(t){return 1/(1+Math.exp(-t))},df:function(t){return t=1/(1+Math.exp(-t)),t*(1-t)}},tanh:{f:function(t){return i(t)},df:function(t){return t=i(t),1-t*t}},linear:{f:function(t){return t},df:function(t){return 1}}};!function(t){function n(t,n){for(var i=new Array(t),e=0;t>e;e++)i[e]=n(e);return i}t.makeArray=n}(n=t.Util||(t.Util={}));var o=function(){function i(i,e,o,u,p,h,c){var l=this;void 0===p&&(p=!0),void 0===h&&(h=function(){return Math.random()-.5}),this.learnRate=u,this.bias=p,this.startWeights=c,this.layers=[],this.connections=[];var f=0;this.inputs=n.makeArray(i.neuronCount,function(t){return new r(f++,i.names[t])}),this.layers.push(this.inputs.slice());for(var d=0;d<e.length;d++){var g=e[d];this.layers.push(n.makeArray(g.neuronCount,function(t){return new a(g.activation,f++)}))}this.outputs=n.makeArray(o.neuronCount,function(t){return new s(o.activation,f++,o.names[t])}),this.layers.push(this.outputs),this.bias=p;for(var m=0;m<this.layers.length-1;m++){var y=this.layers[m],v=this.layers[m+1];p&&y.push(new r(f++,"Bias",1));for(var C=0;C<y.length;C++)for(var w=y[C],x=0;x<v.length;x++){var L=v[x],M=new t.NeuronConnection(w,L);w.outputs.push(M),L.inputs.push(M),this.connections.push(M)}}this.startWeights?this.startWeights.forEach(function(t,n){return l.connections[n].weight=t}):this.startWeights=this.connections.map(function(t){return t.weight=h()})}return i.prototype.setInputsAndCalculate=function(t){for(var n=0;n<this.inputs.length;n++)this.inputs[n].output=t[n];for(var i=0,e=this.layers.slice(1);i<e.length;i++)for(var o=e[i],u=0;u<o.length;u++){var a=o[u];a.calculateOutput()}},i.prototype.getOutput=function(t){return this.setInputsAndCalculate(t),this.outputs.map(function(t){return t.output})},i.prototype.getLoss=function(t){for(var n=0,i=0;i<this.outputs.length;i++){var e=this.outputs[i];n+=Math.pow(e.output-t[i],2)}return Math.sqrt(n/this.outputs.length)},i.prototype.train=function(t,n){this.setInputsAndCalculate(t);for(var i=0;i<this.outputs.length;i++)this.outputs[i].targetOutput=n[i];for(var e=this.layers.length-1;e>0;e--)for(var o=0,u=this.layers[e];o<u.length;o++){var a=u[o];a.calculateError();for(var r=0,s=a.inputs;r<s.length;r++){var p=s[r];p.calculateDeltaWeight(this.learnRate)}}for(var h=0,c=this.connections;h<c.length;h++){var p=c[h];p.weight+=p.deltaWeight}},i}();t.NeuralNet=o;var u=function(){function t(t,n){this.inp=t,this.out=n,this.deltaWeight=0,this.weight=0}return t.prototype.calculateDeltaWeight=function(t){this.deltaWeight=t*this.out.error*this.inp.output},t}();t.NeuronConnection=u;var a=function(){function t(t,n){this.activation=t,this.id=n,this.inputs=[],this.outputs=[],this.weightedInputs=0,this.output=0,this.error=0}return t.prototype.calculateWeightedInputs=function(){this.weightedInputs=0;for(var t=0,n=this.inputs;t<n.length;t++){var i=n[t];this.weightedInputs+=i.inp.output*i.weight}},t.prototype.calculateOutput=function(){this.calculateWeightedInputs(),this.output=e[this.activation].f(this.weightedInputs)},t.prototype.calculateError=function(){for(var t=0,n=0,i=this.outputs;n<i.length;n++){var o=i[n];t+=o.out.error*o.weight}this.error=t*e[this.activation].df(this.weightedInputs)},t}();t.Neuron=a;var r=function(t){function n(n,i,e){t.call(this,null,n),this.name=i,this.constant=!1,void 0!==e&&(this.output=e,this.constant=!0)}return __extends(n,t),n.prototype.calculateOutput=function(){},n.prototype.calculateWeightedInputs=function(){},n.prototype.calculateError=function(){},n}(a);t.InputNeuron=r;var s=function(t){function n(n,i,e){t.call(this,n,i),this.activation=n,this.name=e}return __extends(n,t),n.prototype.calculateError=function(){this.error=e[this.activation].df(this.weightedInputs)*(this.targetOutput-this.output)},n}(a);t.OutputNeuron=s}(Net||(Net={}));var NeuronGui=function(){function t(t){var n=this;this.sim=t,this.layerDiv=$("#hiddenLayersModify > div").clone(),$("#hiddenLayersModify").on("click","button",function(n){var i="+"==n.target.textContent,e=$(n.target.parentNode).index(),o=t.config.hiddenLayers[e].neuronCount+(i?1:-1);1>o||(t.config.hiddenLayers[e].neuronCount=o,$("#hiddenLayersModify .neuronCount").eq(e).text(o),t.setIsCustom(),t.initializeNet())}),$("#inputLayerModify,#outputLayerModify").on("click","button",function(n){var i=$(n.target).closest("#inputLayerModify").length>0,e=i?"input":"output",o=i?t.config.inputLayer:t.config.outputLayer,u="+"==n.target.textContent,a=o.neuronCount+(u?1:-1);1>a||(o.neuronCount=a,$("#"+e+"LayerModify .neuronCount").text(a),t.config.data=[],t.setIsCustom(!0),t.initializeNet())}),$("#layerCountModifier").on("click","button",function(i){var e="+"==i.target.textContent;if(e)t.config.hiddenLayers.unshift({activation:"sigmoid",neuronCount:2}),n.addLayer();else{if(0==t.config.hiddenLayers.length)return;t.config.hiddenLayers.shift(),n.removeLayer()}$("#layerCount").text(t.config.hiddenLayers.length+2),t.setIsCustom(),t.initializeNet()}),$("#outputLayerModify").on("change","select",function(n){t.config.outputLayer.activation=n.target.value,t.setIsCustom(),t.initializeNet()}),$("#hiddenLayersModify").on("change","select",function(n){var i=$(n.target.parentNode).index();t.config.hiddenLayers[i].activation=n.target.value,t.setIsCustom(),t.initializeNet()})}return t.prototype.removeLayer=function(){$("#hiddenLayersModify > div").eq(0).remove()},t.prototype.addLayer=function(){$("#hiddenLayersModify > div").eq(0).before(this.layerDiv.clone())},t.prototype.setActivation=function(t,n){},t.prototype.regenerate=function(){for(var t=this.sim.config.hiddenLayers.length;$("#hiddenLayersModify > div").length>t;)this.removeLayer();for(;$("#hiddenLayersModify > div").length<t;)this.addLayer();this.sim.config.hiddenLayers.forEach(function(t,n){$("#hiddenLayersModify .neuronCount").eq(n).text(t.neuronCount),$("#hiddenLayersModify > div").eq(n).children("select.activation").val(t.activation)}),$("#outputLayerModify").children("select.activation").val(this.sim.config.outputLayer.activation),$("#inputLayerModify .neuronCount").text(this.sim.config.inputLayer.neuronCount),$("#outputLayerModify .neuronCount").text(this.sim.config.outputLayer.neuronCount),$("#layerCount").text(this.sim.config.hiddenLayers.length+2)},t}(),Presets;!function(t){function n(){return r.map(function(t){return t.name}).filter(function(t){return"Default"!==t})}function i(t){return void 0!==r.filter(function(n){return n.name===t})[0]}function e(t){var n=[],i=r.filter(function(n){return n.name===t})[0];for(n.unshift(i);;){var e=i.parent||"Default";if(i=r.filter(function(t){return t.name===e})[0],n.unshift(i),"Default"===e)break}return n.unshift({}),console.log("loading preset chain: "+n.map(function(t){return t.name})),JSON.parse(JSON.stringify($.extend.apply($,n)))}function o(t,n){void 0===n&&(n="Default");var i=e(n),o={};for(var u in t.config)t.config[u]!==i[u]&&(o[u]=t.config[u]);return o}function u(){function t(t){var n=t.filter(function(t){return 1==t[3]}).map(function(t){return{input:t.slice(0,2),output:Util.arrayWithOneAt(10,t[2])}});a(n),r.filter(function(t){return"Peterson and Barney (male)"===t.name})[0].data=n;var i=t.map(function(t){return{input:t.slice(0,2),output:Util.arrayWithOneAt(10,t[2])}});a(n),r.filter(function(t){return"Peterson and Barney (all)"===t.name})[0].data=i}var n="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";t(JSON.parse(LZString.decompressFromBase64(n)))}function a(t){var n=Util.bounds2dTrainingsInput(t);t.forEach(function(t){return t.input=[(t.input[0]-n.minx)/(n.maxx-n.minx),(t.input[1]-n.miny)/(n.maxy-n.miny)]})}var r=[{name:"Default",stepsPerFrame:50,learningRate:.05,showGradient:!1,bias:!1,autoRestartTime:5e3,autoRestart:!1,iterationsPerClick:5e3,data:[{input:[0,0],output:[0]},{input:[0,1],output:[1]},{input:[1,0],output:[1]},{input:[1,1],output:[0]}],inputLayer:{neuronCount:2,names:["x","y"]},outputLayer:{neuronCount:1,activation:"sigmoid",names:["x XOR y"]},hiddenLayers:[{neuronCount:2,activation:"sigmoid"}]},{name:"Binary Classifier for XOR"},{name:"Binary Classifier for circular data",hiddenLayers:[{neuronCount:3,activation:"sigmoid"}],inputLayer:{neuronCount:2,names:["x","y"]},outputLayer:{neuronCount:1,activation:"sigmoid",names:["Class"]},data:[{input:[1.46,1.36],output:[0]},{input:[1.14,1.26],output:[0]},{input:[.96,.97],output:[0]},{input:[1.04,.76],output:[0]},{input:[1.43,.81],output:[0]},{input:[1.3,1.05],output:[0]},{input:[1.45,1.22],output:[0]},{input:[2.04,1.1],output:[0]},{input:[1.06,.28],output:[0]},{input:[.96,.57],output:[0]},{input:[1.28,.46],output:[0]},{input:[1.51,.33],output:[0]},{input:[1.65,.68],output:[0]},{input:[1.67,1.01],output:[0]},{input:[1.5,1.83],output:[1]},{input:[.76,1.69],output:[1]},{input:[.4,.71],output:[1]},{input:[.61,1.18],output:[1]},{input:[.26,1.42],output:[1]},{input:[.28,1.89],output:[1]},{input:[1.37,1.89],output:[1]},{input:[1.11,1.9],output:[1]},{input:[1.05,2.04],output:[1]},{input:[2.43,1.42],output:[1]},{input:[2.39,1.2],output:[1]},{input:[2.1,1.53],output:[1]},{input:[1.89,1.72],output:[1]},{input:[2.69,.72],output:[1]},{input:[2.96,.44],output:[1]},{input:[2.5,.79],output:[1]},{input:[2.85,1.23],output:[1]},{input:[2.82,1.37],output:[1]},{input:[1.93,1.9],output:[1]},{input:[2.18,1.77],output:[1]},{input:[2.29,.39],output:[1]},{input:[2.57,.22],output:[1]},{input:[2.7,-.11],output:[1]},{input:[1.96,-.2],output:[1]},{input:[1.89,-.1],output:[1]},{input:[1.77,.13],output:[1]},{input:[.73,.01],output:[1]},{input:[.37,.31],output:[1]},{input:[.46,.44],output:[1]},{input:[.48,.11],output:[1]},{input:[.37,-.1],output:[1]},{input:[1.03,-.42],output:[1]},{input:[1.35,-.25],output:[1]},{input:[1.17,.01],output:[1]},{input:[.12,.94],output:[1]},{input:[2.05,.32],output:[1]},{input:[1.97,.55],output:[0]}]},{name:"Three classes test",hiddenLayers:[{neuronCount:4,activation:"sigmoid"}],inputLayer:{neuronCount:2,names:["x","y"]},outputLayer:{neuronCount:3,activation:"sigmoid",names:["A","B","C"]},data:[{input:[1.4,1.3],output:[1,0,0]},{input:[1.56,1.36],output:[1,0,0]},{input:[1.36,1.36],output:[1,0,0]},{input:[1.46,1.36],output:[1,0,0]},{input:[1.14,1.26],output:[1,0,0]},{input:[.96,.97],output:[1,0,0]},{input:[1.04,.76],output:[1,0,0]},{input:[1.43,.81],output:[1,0,0]},{input:[1.3,1.05],output:[1,0,0]},{input:[1.45,1.22],output:[1,0,0]},{input:[2.04,1.1],output:[1,0,0]},{input:[1.06,.28],output:[1,0,0]},{input:[.96,.57],output:[1,0,0]},{input:[1.28,.46],output:[1,0,0]},{input:[1.51,.33],output:[1,0,0]},{input:[1.65,.68],output:[1,0,0]},{input:[1.67,1.01],output:[1,0,0]},{input:[1.5,1.83],output:[0,1,0]},{input:[.76,1.69],output:[0,1,0]},{input:[.4,.71],output:[0,1,0]},{input:[.61,1.18],output:[0,1,0]},{input:[.26,1.42],output:[0,1,0]},{input:[.28,1.89],output:[0,1,0]},{input:[1.37,1.89],output:[0,1,0]},{input:[1.11,1.9],output:[0,1,0]},{input:[1.05,2.04],output:[0,1,0]},{input:[2.43,1.42],output:[0,1,0]},{input:[2.39,1.2],output:[0,1,0]},{input:[2.1,1.53],output:[0,1,0]},{input:[1.89,1.72],output:[0,1,0]},{input:[2.69,.72],output:[0,1,0]},{input:[2.96,.44],output:[0,1,0]},{input:[2.5,.79],output:[0,1,0]},{input:[2.85,1.23],output:[0,1,0]},{input:[2.82,1.37],output:[0,1,0]},{input:[1.93,1.9],output:[0,1,0]},{input:[2.18,1.77],output:[0,1,0]},{input:[2.29,.39],output:[0,1,0]},{input:[2.57,.22],output:[0,1,0]},{input:[2.7,-.11],output:[0,1,0]},{input:[1.96,-.2],output:[0,1,0]},{input:[1.89,-.1],output:[0,1,0]},{input:[1.77,.13],output:[0,1,0]},{input:[.73,.01],output:[0,1,0]},{input:[.37,.31],output:[0,1,0]},{input:[.46,.44],output:[0,1,0]},{input:[.48,.11],output:[0,1,0]},{input:[.37,-.1],output:[0,1,0]},{input:[1.03,-.42],output:[0,1,0]},{input:[1.35,-.25],output:[0,1,0]},{input:[1.17,.01],output:[0,1,0]},{input:[.12,.94],output:[0,1,0]},{input:[2.05,.32],output:[0,1,0]},{input:[1.97,.55],output:[1,0,0]},{input:[.7860082304526748,2.5761316872427984],output:[0,0,1]},{input:[-.09053497942386843,2.3909465020576133],output:[0,0,1]},{input:[-.23868312757201657,2.0329218106995888],output:[0,0,1]},{input:[-.32510288065843634,1.748971193415638],output:[0,0,1]},{input:[-.6707818930041154,1.4526748971193417],output:[0,0,1]},{input:[-.3991769547325104,1.094650205761317],output:[0,0,1]},{input:[-.2263374485596709,.6131687242798356],output:[0,0,1]},{input:[-.2263374485596709,-.42386831275720144],output:[0,0,1]},{input:[-.13991769547325114,-.6584362139917693],output:[0,0,1]},{input:[1.5390946502057612,-1.0658436213991767],output:[0,0,1]},{input:[2.193415637860082,-1.0781893004115224],output:[0,0,1]},{input:[2.6502057613168724,-.9176954732510286],output:[0,0,1]},{input:[3.193415637860082,-.6460905349794236],output:[0,0,1]},{input:[3.526748971193415,-.42386831275720144],output:[0,0,1]},{input:[3.4403292181069953,.329218106995885],output:[0,0,1]},{input:[3.4773662551440325,1.0452674897119343],output:[0,0,1]},{input:[3.6625514403292176,1.2798353909465023],output:[0,0,1]},{input:[2.8847736625514404,2.946502057613169],output:[0,0,1]},{input:[1.4156378600823043,2.5514403292181074],output:[0,0,1]},{input:[1.045267489711934,2.526748971193416],output:[0,0,1]},{input:[2.5144032921810697,2.1563786008230457],output:[0,0,1]},{input:[3.045267489711934,1.7983539094650207],output:[0,0,1]},{input:[2.366255144032922,2.9341563786008233],output:[0,0,1]},{input:[1.5020576131687242,3.0576131687242802],output:[0,0,1]},{input:[.5390946502057612,2.711934156378601],output:[0,0,1]},{input:[-.300411522633745,2.5761316872427984],output:[0,0,1]},{input:[-.7942386831275722,2.563786008230453],output:[0,0,1]},{input:[-1.1646090534979425,1.181069958847737],output:[0,0,1]},{input:[-1.1275720164609055,.5637860082304529],output:[0,0,1]},{input:[-.5226337448559671,.46502057613168746],output:[0,0,1]},{input:[-.4115226337448561,-.05349794238683104],output:[0,0,1]},{input:[-.1646090534979425,-.7325102880658434],output:[0,0,1]},{input:[.4650205761316871,-.8436213991769544],output:[0,0,1]},{input:[.8106995884773661,-1.164609053497942],output:[0,0,1]},{input:[.32921810699588466,-1.3004115226337447],output:[0,0,1]},{input:[1.1687242798353907,-1.127572016460905],output:[0,0,1]},{input:[2.1316872427983538,-1.362139917695473],output:[0,0,1]},{input:[1.7119341563786008,-.6954732510288063],output:[0,0,1]},{input:[2.5267489711934155,-.8930041152263373],output:[0,0,1]},{input:[2.8971193415637857,-.8930041152263373],output:[0,0,1]},{input:[2.6378600823045266,-.6460905349794236],output:[0,0,1]},{input:[3.2427983539094645,-.5349794238683125],output:[0,0,1]},{input:[3.8477366255144028,.02057613168724303],output:[0,0,1]},{input:[3.390946502057613,.02057613168724303],output:[0,0,1]},{input:[3.4403292181069953,.3415637860082307],output:[0,0,1]},{input:[3.7983539094650203,.6502057613168727],output:[0,0,1]},{input:[3.526748971193415,.983539094650206],output:[0,0,1]},{input:[3.452674897119341,1.4526748971193417],output:[0,0,1]},{input:[3.502057613168724,1.7242798353909468],output:[0,0,1]},{input:[3.415637860082304,2.205761316872428],output:[0,0,1]},{input:[2.736625514403292,2.292181069958848],output:[0,0,1]},{input:[1.9465020576131686,2.403292181069959],output:[0,0,1]},{input:[1.8230452674897117,2.60082304526749],output:[0,0,1]},{input:[3.008230452674897,-1.288065843621399],output:[0,0,1]},{input:[1.699588477366255,-1.016460905349794],output:[0,0,1]},{input:[2.045267489711934,-.9053497942386829],output:[0,0,1]},{input:[1.8724279835390945,-1.2263374485596705],output:[0,0,1]}]},{name:"Peterson and Barney (male)",parent:"Three classes test",stepsPerFrame:6,iterationsPerClick:50,inputLayer:{neuronCount:2,names:["F1","F2"]},outputLayer:{neuronCount:10,activation:"sigmoid",names:"IY,IH,EH,AE,AH,AA,AO,UH,UW,ER".split(",")}},{name:"Peterson and Barney (all)",parent:"Peterson and Barney (male)"},{name:"Auto-Encoder for linear data",stepsPerFrame:1,iterationsPerClick:1,parent:"Auto-Encoder for circular data",data:[{input:[2.25,.19],output:[2.25,.19]},{input:[1.37,.93],output:[1.37,.93]},{input:[.62,1.46],output:[.62,1.46]},{input:[-.23,2.16],output:[-.23,2.16]},{input:[-.55,2.44],output:[-.55,2.44]},{input:[1.04,1.05],output:[1.04,1.05]},{input:[1.7,.85],output:[1.7,.85]},{input:[2.01,.46],output:[2.01,.46]},{input:[.4,1.73],output:[.4,1.73]},{input:[2.73,.01],output:[2.73,.01]},{input:[2.86,-.25],output:[2.86,-.25]},{input:[.14,2.07],output:[.14,2.07]}],hiddenLayers:[{neuronCount:1,activation:"sigmoid"}],showGradient:!0},{name:"Auto-Encoder for x^2",parent:"Auto-Encoder for circular data",netLayers:[{activation:"sigmoid",neuronCount:2},{activation:"linear",neuronCount:1},{neuronCount:2,activation:"sigmoid"}],data:Array.apply(null,Array(17)).map(function(t,n){return(n-8)/8}).map(function(t){return{input:[t,t*t],output:[t,t*t]}})},{name:"Auto-Encoder for circular data",stepsPerFrame:250,learningRate:.01,iterationsPerClick:1e4,inputLayer:{neuronCount:2,names:["x","y"]},outputLayer:{neuronCount:2,activation:"linear",names:["x","y"]},hiddenLayers:[{activation:"sigmoid",neuronCount:3},{activation:"linear",neuronCount:1},{neuronCount:3,activation:"sigmoid"}],data:[{input:[-.83,.55],output:[-.83,.55]},{input:[-.98,.21],output:[-.98,.21]},{input:[-.77,-.64],output:[-.77,-.64]},{input:[.95,.31],output:[.95,.31]},{input:[-.86,-.51],output:[-.86,-.51]},{input:[.99,-.11],output:[.99,-.11]},{input:[.97,.24],output:[.97,.24]},{input:[.85,.52],output:[.85,.52]},{input:[-.99,.15],output:[-.99,.15]},{input:[.62,.78],output:[.62,.78]},{input:[.46,-.89],output:[.46,-.89]},{input:[-.68,-.73],output:[-.68,-.73]},{input:[.6,-.8],output:[.6,-.8]},{input:[.38,.92],output:[.38,.92]},{input:[.76,.65],output:[.76,.65]},{input:[.33,-.94],output:[.33,-.94]},{input:[-.99,-.17],output:[-.99,-.17]},{input:[-.99,-.17],output:[-.99,-.17]},{input:[-.97,-.26],output:[-.97,-.26]},{input:[-.79,-.61],output:[-.79,-.61]},{input:[-.03,-1],output:[-.03,-1]},{input:[.58,.81],output:[.58,.81]},{input:[-.67,-.74],output:[-.67,-.74]},{input:[.14,.99],output:[.14,.99]},{input:[.13,-.99],output:[.13,-.99]},{input:[.76,.65],output:[.76,.65]},{input:[-.49,.87],output:[-.49,.87]},{input:[-.28,.96],output:[-.28,.96]},{input:[.47,-.88],output:[.47,-.88]},{input:[-.03,1],output:[-.03,1]},{input:[-.7,.71],output:[-.7,.71]},{input:[.38,.93],output:[.38,.93]},{input:[.62,.79],output:[.62,.79]},{input:[.72,-.69],output:[.72,-.69]},{input:[-.41,-.91],output:[-.41,-.91]},{input:[.74,-.67],output:[.74,-.67]},{input:[.44,.9],output:[.44,.9]},{input:[-.99,-.16],output:[-.99,-.16]},{input:[.62,.78],output:[.62,.78]},{input:[.95,-.39],output:[.95,-.39]},{input:[.86,-.53],output:[.86,-.53]}]},{name:"Auto-Encoder 4D",learningRate:.05,data:[{input:[1,0,0,0],output:[1,0,0,0]},{input:[0,1,0,0],output:[0,1,0,0]},{input:[0,0,1,0],output:[0,0,1,0]},{input:[0,0,0,1],output:[0,0,0,1]}],inputLayer:{neuronCount:4,names:["in1","in2","in3","in4"]},outputLayer:{neuronCount:4,activation:"sigmoid",names:["out1","out2","out3","out4"]},hiddenLayers:[{neuronCount:2,activation:"sigmoid"}],netLayers:[{activation:"sigmoid",neuronCount:2},{activation:"linear",neuronCount:1},{neuronCount:2,activation:"sigmoid"}]}];t.getNames=n,t.exists=i,t.get=e,t.printPreset=o,t.loadPetersonBarney=u}(Presets||(Presets={}));var Simulation=function(){function t(t){var n=this;this.stepNum=0,this.frameNum=0,this.running=!1,this.runningId=-1,this.restartTimeout=-1,this.isCustom=!1,this.averageError=1,this.constructed=!1,this.statusIterEle=document.getElementById("statusIteration"),this.statusCorrectEle=document.getElementById("statusCorrect"),this.aniFrameCallback=this.animationStep.bind(this),$("#learningRate").slider({min:.01,max:1,step:.005,scale:"logarithmic",value:.05}).on("change",function(t){return $("#learningRateVal").text(t.value.newValue.toFixed(3))});for(var i=0,e=Presets.getNames();i<e.length;i++){var o=e[i];$("#presetLoader").append($("<li>").append($("<a>").text(o)))}$("#presetLoader").on("click","a",function(t){var i=t.target.textContent;n.loadPreset(i)});var u=function(){n.stop(),$("#urlExport").text(n.serializeToUrl(+$("#exportWeights").val()))};$("#exportModal").on("shown.bs.modal",u),$("#exportModal select").on("change",u),this.neuronGui=new NeuronGui(this),this.netviz=new NetworkVisualization(this),this.netgraph=new NetworkGraph(this),this.errorGraph=new ErrorGraph(this),this.table=new TableEditor(this),this.weightsGraph=new WeightsGraph(this),this.leftVis=new TabSwitchVisualizationContainer($("#leftVisHeader"),$("#leftVisBody"),"leftVis",[this.netgraph,this.errorGraph,this.weightsGraph]),this.rightVis=new TabSwitchVisualizationContainer($("#rightVisHeader"),$("#rightVisBody"),"rightVis",[this.netviz,this.table]),this.deserializeFromUrl(),this.leftVis.setMode(0),this.rightVis.setMode(0),this.constructed=!0,this.onFrame(!0),t&&this.run()}return t.prototype.initializeNet=function(t){console.log("initializeNet("+t+")"),this.net&&this.stop(),this.net=new Net.NeuralNet(this.config.inputLayer,this.config.hiddenLayers,this.config.outputLayer,this.config.learningRate,!0,void 0,t),this.stepNum=0,this.errorHistory=[],this.leftVis.onNetworkLoaded(this.net),this.rightVis.onNetworkLoaded(this.net),this.constructed&&this.onFrame(!0)},t.prototype.step=function(){this.stepNum++;for(var t=0,n=this.config.data;t<n.length;t++){var i=n[t];this.net.train(i.input,i.output)}},t.prototype.onFrame=function(t){this.frameNum++,this.calculateAverageError(),this.rightVis.currentVisualization.onFrame(t?0:this.frameNum),this.leftVis.currentVisualization.onFrame(t?0:this.frameNum),this.updateStatusLine()},t.prototype.run=function(){this.running||($("#runButton").text("Stop").addClass("btn-danger").removeClass("btn-primary"),this.running=!0,this.animationStep())},t.prototype.stop=function(){clearTimeout(this.restartTimeout),$("#runButton").text("Run").addClass("btn-primary").removeClass("btn-danger"),this.restartTimeout=-1,this.running=!1,cancelAnimationFrame(this.runningId)},t.prototype.reset=function(){this.stop(),this.initializeNet(),this.onFrame(!0)},t.prototype.calculateAverageError=function(){this.averageError=0;for(var t=0,n=this.config.data;t<n.length;t++){var i=n[t];this.net.setInputsAndCalculate(i.input),this.averageError+=this.net.getLoss(i.output)}this.averageError/=this.config.data.length,this.errorHistory.push([this.stepNum,this.averageError])},t.prototype.updateStatusLine=function(){var t=this,n=0;if(1===this.config.outputLayer.neuronCount){for(var i=0,e=this.config.data;i<e.length;i++){var o=e[i],u=this.net.getOutput(o.input);+(u[0]>.5)==o.output[0]&&n++}this.statusCorrectEle.innerHTML="Correct: "+n+"/"+this.config.data.length}else this.statusCorrectEle.innerHTML="Error: "+this.averageError.toFixed(2);this.statusIterEle.innerHTML=this.stepNum.toString(),n==this.config.data.length?this.config.autoRestart&&this.running&&-1==this.restartTimeout&&(this.restartTimeout=setTimeout(function(){t.stop(),t.restartTimeout=-1,setTimeout(function(){t.reset(),t.run()},100)},this.config.autoRestartTime)):-1!=this.restartTimeout&&(clearTimeout(this.restartTimeout),this.restartTimeout=-1)},t.prototype.animationStep=function(){for(var t=0;t<this.config.stepsPerFrame;t++)this.step();this.onFrame(!1),this.running&&(this.runningId=requestAnimationFrame(this.aniFrameCallback))},t.prototype.iterations=function(){this.stop();for(var t=0;t<this.config.iterationsPerClick;t++)this.step();this.onFrame(!0)},t.prototype.setIsCustom=function(t){if(void 0===t&&(t=!1),!this.isCustom||t){
this.isCustom=!0,$("#presetName").text("Custom Network");var n=this.config.inputLayer;n.names=Net.Util.makeArray(n.neuronCount,function(t){return"in"+(t+1)}),n=this.config.outputLayer,n.names=Net.Util.makeArray(n.neuronCount,function(t){return"out"+(t+1)})}},t.prototype.loadConfig=function(){var t=this.config,n=$.extend({},t);for(var i in t){var e=document.getElementById(i);e&&("checkbox"==e.type?t[i]=e.checked:"number"==typeof t[i]?t[i]=+e.value:t[i]=e.value)}n.simType!=t.simType&&(t.data=[]),this.net&&(this.net.learnRate=this.config.learningRate),this.config.autoRestart||clearTimeout(this.restartTimeout)},t.prototype.loadPreset=function(t,n){this.isCustom=!1,$("#presetName").text("Preset: "+t),this.config=Presets.get(t),this.setConfig(),history.replaceState({},"","?"+$.param({preset:t})),this.initializeNet(n)},t.prototype.setConfig=function(){var t=this.config;for(var n in t){var i=document.getElementById(n);i&&("checkbox"==i.type?i.checked=t[n]:i.value=t[n])}$("#learningRate").slider("setValue",this.config.learningRate),$("#learningRateVal").text(this.config.learningRate.toFixed(3)),this.neuronGui.regenerate()},t.prototype.runtoggle=function(){this.running?this.stop():this.run()},t.prototype.serializeToUrl=function(t){void 0===t&&(t=0);var n=location.protocol+"//"+location.host+location.pathname+"?",i={};return 1===t&&(i.weights=LZString.compressToEncodedURIComponent(JSON.stringify(this.net.connections.map(function(t){return t.weight})))),2===t&&(i.weights=LZString.compressToEncodedURIComponent(JSON.stringify(this.net.startWeights))),this.isCustom?i.config=LZString.compressToEncodedURIComponent(JSON.stringify(this.config)):i.preset=this.config.name,n+$.param(i)},t.prototype.deserializeFromUrl=function(){var t,n=Util.parseUrlParameters(),i=n.preset,e=n.config,o=n.weights;o&&(t=JSON.parse(LZString.decompressFromEncodedURIComponent(o))),i&&Presets.exists(i)?this.loadPreset(i,t):e?(this.config=JSON.parse(LZString.decompressFromEncodedURIComponent(e)),this.setIsCustom(),this.initializeNet()):this.loadPreset("Binary Classifier for XOR")},t}(),TransformNavigation=function(){function t(t,n,i){var e=this;this.scalex=200,this.scaley=-200,this.offsetx=0,this.offsety=0,this.mousedown=!1,this.mousestart={x:0,y:0},this.toReal={x:function(t){return(t-e.offsetx)/e.scalex},y:function(t){return(t-e.offsety)/e.scaley}},this.toCanvas={x:function(t){return t*e.scalex+e.offsetx},y:function(t){return t*e.scaley+e.offsety}},this.offsetx=t.width/4,this.offsety=3*t.height/4,t.addEventListener("wheel",function(t){if(0!==t.deltaY&&n()){var o=t.deltaY/Math.abs(t.deltaY);e.scalex*=1-o/10,e.scaley*=1-o/10,i(),t.preventDefault()}}),t.addEventListener("mousedown",function(t){n()&&(e.mousedown=!0,e.mousestart.x=t.pageX,e.mousestart.y=t.pageY)}),t.addEventListener("mousemove",function(t){n()&&e.mousedown&&(e.offsetx+=t.pageX-e.mousestart.x,e.offsety+=t.pageY-e.mousestart.y,e.mousestart.x=t.pageX,e.mousestart.y=t.pageY,i())}),document.addEventListener("mouseup",function(t){return e.mousedown=!1})}return t}(),Util;!function(t){function n(t){for(var n=t[0],i=0,e=1;e<t.length;e++)t[e]>n&&(n=t[e],i=e);return i}function i(t,n){for(var i=new Array(t),e=0;t>e;e++)i[e]=e===n?1:0;return i}function e(t){return t.reduce(function(t,n){return Math.min(t,n)},1/0)}function o(t){return t.reduce(function(t,n){return Math.max(t,n)},-(1/0))}function u(n){return{minx:t.min(n.map(function(t){return t.input[0]})),miny:t.min(n.map(function(t){return t.input[1]})),maxx:t.max(n.map(function(t){return t.input[0]})),maxy:t.max(n.map(function(t){return t.input[1]}))}}function a(t,n){if(void 0===t&&(t=0),void 0===n&&(n=1),void 0!==c){var i=c;return c=void 0,i*n+t}var e,o,u,a;do e=2*Math.random()-1,o=2*Math.random()-1,u=e*e+o*o;while(u>=1||0==u);return a=Math.sqrt(-2*Math.log(u)/u),c=o*a,e*a*n+t}function r(t){var n=Date.now();t();return Date.now()-n}function s(t){var n=t.match(/^#([0-9a-f]{6})$/i)[1];return n?[parseInt(n.substr(0,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(4,2),16)]:void 0}function p(t){return t=t.map(function(t){return 0>t?0:t>255?255:t}),"#"+("000000"+(t[0]<<16|t[1]<<8|t[2]).toString(16)).slice(-6)}function h(){if(!location.search)return{};for(var t={},n=0,i=location.search.slice(1).split("&");n<i.length;n++){var e=i[n],o=e.split("=").map(function(t){return t.replace(/\+/g," ")});t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}t.getMaxIndex=n,t.arrayWithOneAt=i,t.min=e,t.max=o,t.bounds2dTrainingsInput=u;var c;t.randomGaussian=a,t.benchmark=r,t.parseColor=s,t.printColor=p,t.parseUrlParameters=h}(Util||(Util={}));var ErrorGraph=function(){function t(t){this.sim=t,this.actions=["Error History"],this.container=$("<div>"),this.container.highcharts({title:{text:"Average RMSE"},chart:{type:"line",animation:!1},plotOptions:{line:{marker:{enabled:!1}}},legend:{enabled:!1},yAxis:{min:0,title:{text:""},labels:{format:"{value:%.2f}"}},series:[{name:"Error",data:[]}],colors:["black"],credits:{enabled:!1}}),this.chart=this.container.highcharts()}return t.prototype.onFrame=function(){var t=[this.sim.stepNum,this.sim.averageError];this.chart.series[0].addPoint(t,!0,!1)},t.prototype.onView=function(){this.chart.series[0].setData(this.sim.errorHistory.map(function(t){return t.slice()})),this.chart.reflow()},t.prototype.onNetworkLoaded=function(){this.chart.series[0].setData([])},t.prototype.onHide=function(){},t}(),NetworkGraph=function(){function t(t){this.sim=t,this.actions=["Network Graph"],this.container=$("<div>"),this.instantiateGraph()}return t.prototype.instantiateGraph=function(){this.nodes=new vis.DataSet([],{queue:!0}),this.edges=new vis.DataSet([],{queue:!0});var t={nodes:this.nodes,edges:this.edges},n={nodes:{shape:"dot"},edges:{smooth:{type:"curvedCW",roundness:0},font:{align:"top",background:"white"}},layout:{hierarchical:{direction:"LR"}},interaction:{dragNodes:!1}};this.graph&&this.graph.destroy(),this.graph=new vis.Network(this.container[0],t,n)},t.prototype.onNetworkLoaded=function(t){var n=this.sim.config.bias;if(this.net&&this.net.layers.length==t.layers.length&&this.net.layers.every(function(n,i){return n.length==t.layers[i].length}))return this.net=t,void this.onFrame(0);this.instantiateGraph(),this.net=t;for(var i=0;i<t.layers.length;i++)for(var e=t.layers[i],o=0;o<e.length;o++){var u=e[o],a="Hidden Neuron "+(o+1),r="#000";if(u instanceof Net.InputNeuron)if(a="Input: "+u.name,u.constant){if(!n)continue;r=NetworkVisualization.colors.autoencoder.bias}else r=NetworkVisualization.colors.autoencoder.input;u instanceof Net.OutputNeuron&&(a="Output: "+u.name,r=NetworkVisualization.colors.autoencoder.output),this.nodes.add({id:u.id,label:""+a,level:i,color:r})}for(var s=0,p=t.connections;s<p.length;s++){var h=p[s];this.edges.add({id:h.inp.id*t.connections.length+h.out.id,from:h.inp.id,to:h.out.id,arrows:"to",label:h.weight.toFixed(2)})}this.nodes.flush(),this.edges.flush()},t.prototype.onFrame=function(t){if(!(this.net.connections.length>20&&t%15!==0)){for(var n=0,i=this.net.connections;n<i.length;n++){var e=i[n];this.edges.update({id:e.inp.id*this.net.connections.length+e.out.id,label:e.weight.toFixed(2),width:Math.min(6,Math.abs(2*e.weight)),color:e.weight>0?"blue":"red"})}this.edges.flush()}},t.prototype.onView=function(){this.graph.stabilize()},t.prototype.onHide=function(){},t}(),InputMode;!function(t){t[t.InputPrimary=0]="InputPrimary",t[t.InputSecondary=1]="InputSecondary",t[t.Remove=2]="Remove",t[t.Move=3]="Move",t[t.Table=4]="Table"}(InputMode||(InputMode={}));var NetType;!function(t){t[t.BinaryClassify=0]="BinaryClassify",t[t.AutoEncode=1]="AutoEncode",t[t.MultiClass=2]="MultiClass",t[t.CantDraw=3]="CantDraw"}(NetType||(NetType={}));var NetworkVisualization=function(){function t(n){var i=this;this.sim=n,this.actions=[],this.inputMode=0,this.backgroundResolution=15,this.container=$("<div>"),this.netType=NetType.BinaryClassify;var e=t.colors.multiClass;e.bg=e.fg.map(function(t){return Util.printColor(Util.parseColor(t).map(function(t){return 1.3*t|0}))}),this.canvas=$("<canvas class=fullsize>")[0],this.canvas.width=550,this.canvas.height=400,this.trafo=new TransformNavigation(this.canvas,function(){return i.inputMode==i.actions.length-1},function(){return i.onFrame()}),this.ctx=this.canvas.getContext("2d"),window.addEventListener("resize",this.canvasResized.bind(this)),this.canvas.addEventListener("click",this.canvasClicked.bind(this)),this.canvas.addEventListener("contextmenu",this.canvasClicked.bind(this)),$(this.canvas).appendTo(this.container)}return t.prototype.onNetworkLoaded=function(n){switch(2!=n.inputs.length?this.netType=NetType.CantDraw:1==n.outputs.length?this.netType=NetType.BinaryClassify:2==n.outputs.length?this.netType=NetType.AutoEncode:this.netType=NetType.MultiClass,this.netType){case NetType.BinaryClassify:this.actions=["Add Red","Add Green","Remove","Move View"];break;case NetType.AutoEncode:this.actions=["Add Data point","","Remove","Move View"];break;case NetType.MultiClass:this.actions=[];for(var i=0,e=0,o=this.sim.config.outputLayer.names;e<o.length;e++){var u=o[e];this.actions.push({name:u,color:t.colors.multiClass.bg[i++]})}this.actions.push("Remove"),this.actions.push("Move View")}this.refitData()},t.prototype.onFrame=function(){return this.netType===NetType.CantDraw?(this.clear("white"),this.ctx.fillStyle="black",this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.font="20px monospace",void this.ctx.fillText("Cannot draw this data",this.canvas.width/2,this.canvas.height/2)):(this.drawBackground(),this.drawCoordinateSystem(),void this.drawDataPoints())},t.prototype.drawDataPoints=function(){if(this.ctx.strokeStyle="#000",this.netType===NetType.BinaryClassify)for(var n=0,i=this.sim.config.data;n<i.length;n++){var e=i[n];this.drawPoint(e.input[0],e.input[1],t.colors.binaryClassify.fg[0|e.output[0]])}else if(this.netType===NetType.AutoEncode)for(var o=0,u=this.sim.config.data;o<u.length;o++){var e=u[o],a=e.input[0],r=e.input[1],s=this.sim.net.getOutput(e.input),p=s[0],h=s[1];this.drawLine(a,r,p,h,"black"),this.drawPoint(a,r,t.colors.autoencoder.input),this.drawPoint(p,h,t.colors.autoencoder.output)}else{if(this.netType!==NetType.MultiClass)throw"can't draw this";for(var c=0,l=this.sim.config.data;c<l.length;c++){var e=l[c];this.drawPoint(e.input[0],e.input[1],t.colors.multiClass.fg[Util.getMaxIndex(e.output)])}}},t.prototype.drawLine=function(t,n,i,e,o){t=this.trafo.toCanvas.x(t),i=this.trafo.toCanvas.x(i),n=this.trafo.toCanvas.y(n),e=this.trafo.toCanvas.y(e),this.ctx.strokeStyle=o,this.ctx.beginPath(),this.ctx.moveTo(t,n),this.ctx.lineTo(i,e),this.ctx.stroke()},t.prototype.drawPoint=function(t,n,i){t=this.trafo.toCanvas.x(t),n=this.trafo.toCanvas.y(n),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(t,n,5,0,2*Math.PI),this.ctx.fill(),this.ctx.arc(t,n,5,0,2*Math.PI),this.ctx.stroke()},t.prototype.clear=function(t){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.drawBackground=function(){if(2===this.sim.config.outputLayer.neuronCount)return void this.clear("white");if(this.sim.config.outputLayer.neuronCount>2)for(var n=0;n<this.canvas.width;n+=this.backgroundResolution)for(var i=0;i<this.canvas.height;i+=this.backgroundResolution){var e=this.sim.net.getOutput([this.trafo.toReal.x(n+this.backgroundResolution/2),this.trafo.toReal.y(i+this.backgroundResolution/2)]),o=Util.getMaxIndex(e);this.ctx.fillStyle=t.colors.multiClass.bg[o],this.ctx.fillRect(n,i,this.backgroundResolution,this.backgroundResolution)}else for(var n=0;n<this.canvas.width;n+=this.backgroundResolution)for(var i=0;i<this.canvas.height;i+=this.backgroundResolution){var u=this.sim.net.getOutput([this.trafo.toReal.x(n+this.backgroundResolution/2),this.trafo.toReal.y(i+this.backgroundResolution/2)])[0];this.sim.config.showGradient?this.ctx.fillStyle=t.colors.binaryClassify.gradient(u):this.ctx.fillStyle=t.colors.binaryClassify.bg[+(u>.5)],this.ctx.fillRect(n,i,this.backgroundResolution,this.backgroundResolution)}},t.prototype.drawCoordinateSystem=function(){var t=.2,n=this.ctx,i=this.trafo.toCanvas;n.strokeStyle="#000",n.fillStyle="#000",n.textBaseline="middle",n.textAlign="center",n.font="20px monospace",n.beginPath(),n.moveTo(i.x(0),0),n.lineTo(i.x(0),this.canvas.height),n.moveTo(i.x(-t/2),i.y(1)),n.lineTo(i.x(t/2),i.y(1)),n.fillText("1",i.x(-t),i.y(1)),n.moveTo(0,i.y(0)),n.lineTo(this.canvas.width,i.y(0)),n.moveTo(i.x(1),i.y(-t/2)),n.lineTo(i.x(1),i.y(t/2)),n.fillText("1",i.x(1),i.y(-t)),n.stroke()},t.prototype.canvasResized=function(){this.canvas.width=$(this.canvas).width(),this.canvas.height=$(this.canvas).height(),this.refitData(),this.onFrame()},t.prototype.refitData=function(){if(0!=this.sim.config.data.length&&2==this.sim.config.inputLayer.neuronCount){var t=.6,n=Util.bounds2dTrainingsInput(this.sim.config.data),i=n.maxx-n.minx,e=n.maxy-n.miny;this.trafo.scalex=this.canvas.width/i*t,this.trafo.scaley=-this.canvas.height/e*t,this.trafo.offsetx-=this.trafo.toCanvas.x(n.minx-i*(1-t)/1.5),this.trafo.offsety-=this.trafo.toCanvas.y(n.maxy+e*(1-t)/1.5)}},t.prototype.canvasClicked=function(t){t.preventDefault();var n=this.sim.config.data,i=this.canvas.getBoundingClientRect(),e=this.trafo.toReal.x(t.clientX-i.left),o=this.trafo.toReal.y(t.clientY-i.top),u=this.actions.length-2;if(this.inputMode===u||2==t.button||t.shiftKey){for(var a=1/0,r=-1,s=0;s<n.length;s++){var p=n[s],h=p.input[0]-e,c=p.input[1]-o,l=h*h+c*c;a>l&&(r=s,a=l)}r>=0&&n.splice(r,1)}else{if(!(this.inputMode<u))return;if(this.netType===NetType.AutoEncode)n.push({input:[e,o],output:[e,o]});else{var f=function(t){return 0==t?1:0},d=this.inputMode;0!=t.button&&(d=f(d)),(t.ctrlKey||t.metaKey||t.altKey)&&(d=f(d));var g=[d];this.netType===NetType.MultiClass&&(g=Util.arrayWithOneAt(this.sim.config.outputLayer.neuronCount,d)),n.push({input:[e,o],output:g})}}this.sim.setIsCustom(),this.onFrame()},t.prototype.onView=function(t,n){t&&this.canvasResized(),this.inputMode=n,this.onFrame()},t.prototype.onHide=function(){},t.colors={binaryClassify:{bg:["#f88","#8f8"],fg:["#f00","#0f0"],gradient:function(t){return"rgb("+[(196*(1-t)|0)+60,(196*t|0)+60,60]+")"}},autoencoder:{input:"#2188e0",output:"#ff931f",bias:"#008"},multiClass:{fg:["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"],bg:[""]}},t}(),TableEditor=function(){function t(t){this.sim=t,this.actions=["Table input"],this.headerCount=2,this.lastUpdate=0,this.container=$("<div>"),this.sim=t}return t.prototype.afterChange=function(t,n){"loadData"!==n&&this.reparseData()},t.prototype.onNetworkLoaded=function(t){var n=this;this.hot&&this.hot.destroy();var i=this.container;this.container=$("<div class='fullsize'>"),$("<div>").addClass("btn btn-default").css({position:"absolute",right:"2em",bottom:"2em"}).text("Remove all").click(function(t){sim.config.data=[],n.loadData()}).appendTo(this.container);var e=function(t,n){Handsontable.renderers.TextRenderer.apply(this,arguments),n.style.fontWeight="bold",n.style.background="#CCC"},o=[],u=t.inputs.length,a=t.outputs.length;u>1&&o.push({row:0,col:0,rowspan:1,colspan:u}),a>1&&(o.push({row:0,col:u,rowspan:1,colspan:a}),o.push({row:0,col:u+a,rowspan:1,colspan:a}));var r={minSpareRows:1,colWidths:6>=u+a+a?80:45,cells:function(t,i,o){if(t>=n.headerCount)return{type:"numeric",format:"0.[000]"};var u={renderer:e};return 0==t&&(u.readOnly=!0),u},customBorders:!1,allowInvalid:!1,mergeCells:o,afterChange:this.afterChange.bind(this)};this.container.handsontable(r),this.hot=this.container.handsontable("getInstance"),i&&i.replaceWith(this.container),this.loadData()},t.prototype.reparseData=function(){var t=this.sim,n=this.hot.getData(),i=n[1],e=t.config.inputLayer.neuronCount,o=t.config.outputLayer.neuronCount;t.config.inputLayer.names=i.slice(0,e),t.config.outputLayer.names=i.slice(e,e+o),t.config.data=n.slice(2).map(function(t){return t.slice(0,e+o)}).filter(function(t){return t.every(function(t){return"number"==typeof t})}).map(function(t){return{input:t.slice(0,e),output:t.slice(e)}}),t.setIsCustom()},t.prototype.onFrame=function(){var t=this.sim;if(!(Date.now()-this.lastUpdate<500)){this.lastUpdate=Date.now();for(var n=t.config.inputLayer.neuronCount+t.config.outputLayer.neuronCount,i=[],e=0;e<t.config.data.length;e++)for(var o=t.config.data[e],u=t.net.getOutput(o.input),a=0;a<u.length;a++)i.push([e+this.headerCount,n+a,u[a]]);this.hot.setDataAtCell(i,"loadData")}},t.prototype.loadData=function(){var t=this.sim,n=[[],t.config.inputLayer.names.concat(t.config.outputLayer.names).concat(t.config.outputLayer.names)],i=t.config.inputLayer.neuronCount,e=t.config.outputLayer.neuronCount;n[0][0]="Inputs",n[0][i]="Expected Output",n[0][i+e+e-1]=" ",n[0][i+e]="Actual Output";var o=[];i>1&&o.push({row:0,col:0,rowspan:1,colspan:i}),e>1&&(o.push({row:0,col:i+e,rowspan:1,colspan:e}),o.push({row:0,col:i+2*e,rowspan:1,colspan:e})),o.length>0&&this.hot.updateSettings({mergeCells:o}),t.config.data.forEach(function(t){return n.push(t.input.concat(t.output))}),this.hot.loadData(n)},t.prototype.onView=function(){this.loadData()},t.prototype.onHide=function(){},t}(),TabSwitchVisualizationContainer=function(){function t(t,n,i,e){var o=this;this.headContainer=t,this.bodyContainer=n,this.name=i,this.things=e,this.modes=[],this.ul=$("<ul class='nav nav-pills'>"),this.body=$("<div class='visbody'>"),this.currentMode=-1,this.createButtonsAndActions(),this.ul.on("click","a",function(t){return o.setMode($(t.target).parent().index())}),t.append(this.ul),n.append(this.body)}return t.prototype.createButtonsAndActions=function(){var t=this;this.ul.empty(),this.modes=[],this.things.forEach(function(n,i){return n.actions.forEach(function(n,e){t.modes.push({thing:i,action:e});var o=$("<a>");if("string"==typeof n)o.text(n);else{o.text(n.name).css("background-color",n.color);var u=Util.parseColor(n.color).reduce(function(t,n){return t+n})/3<127;o.css("color",u?"white":"black")}var a=$("<li>").append(o);n||a.hide(),t.ul.append(a)})})},t.prototype.setMode=function(t){if(this.ul.children("li.custom-active").removeClass("custom-active"),this.ul.children().eq(t).addClass("custom-active"),t!=this.currentMode){var n=this.modes[t],i=this.modes[this.currentMode];this.currentMode=t,this.currentVisualization=this.things[n.thing],i&&n.thing==i.thing?n.action!==i.action&&this.currentVisualization.onView(!1,n.action):(i&&this.things[i.thing].onHide(),this.body.children().detach(),this.body.append(this.currentVisualization.container),this.currentVisualization.onView(!0,n.action))}},t.prototype.onNetworkLoaded=function(t){var n=JSON.stringify(this.things.map(function(t){return t.actions}));this.things.forEach(function(n){return n.onNetworkLoaded(t)});var i=JSON.stringify(this.things.map(function(t){return t.actions}));n!==i&&(this.createButtonsAndActions(),this.setMode(0))},t}(),WeightsGraph=function(){function t(t){var n=this;this.sim=t,this.actions=["Weights"],this.container=$("<div>"),this.offsetBetweenLayers=2,this.xToLayer=[],this.xToNeuron=[],vis.Graph3d.prototype._hsv2rgb=function(t,n,i){return t=0|Math.min(t,250),"rgb("+[t,t,t]+")"},vis.Graph3d.prototype._redrawAxis=function(){},this.graph=new vis.Graph3d(this.container[0],void 0,{style:"bar",showPerspective:!1,cameraPosition:{horizontal:-.001,vertical:Math.PI/2},width:"100%",height:"100%",xLabel:"Layer",yLabel:"Neuron",zLabel:"",showGrid:!0,axisColor:"red",xBarWidth:.9,yBarWidth:.9,xCenter:"50%",legendLabel:"Weight",tooltip:function(t){var i,e,o=n.xToLayer[t.x],u=o-1,a=n.xToNeuron[t.x],r=t.y,s=n.sim.net.layers[u][a],p=n.sim.net.layers[o][r];return i=s instanceof Net.InputNeuron?s.name:"Layer "+(u+1)+" Neuron "+(a+1),e=p instanceof Net.OutputNeuron?p.name:"Layer "+(o+1)+" Neuron "+(r+1),i+" to "+e},xValueLabel:function(t){return n.xToLayer[t]||""},yValueLabel:function(t){return(0|t)==t?t+1:""},zValueLabel:function(t){return""}})}return t.prototype.onView=function(t,n){this.graph.redraw()},t.prototype.onHide=function(){},t.prototype.parseData=function(t){for(var n=[],i=0,e=1;e<t.layers.length;e++)for(var o=t.layers[e],u=i+this.offsetBetweenLayers,a=0;a<o.length;a++){var r=o[a];i=Math.max(i,u+r.inputs.length);for(var s=0;s<r.inputs.length;s++){var p=r.inputs[s];n.push({x:u+s,y:a,z:p.weight}),this.xToLayer[u+s]=e,this.xToNeuron[u+s]=s}}return n},t.prototype.onNetworkLoaded=function(t){this.graph.setData(this.parseData(t))},t.prototype.onFrame=function(){this.graph.setData(this.parseData(this.sim.net))},t}();
//# sourceMappingURL=program.min.js.map